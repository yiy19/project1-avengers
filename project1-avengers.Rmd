---
title: "Project 1 - Avengers"
author: "Ye Dam Yi"
date: "2/16/2021"
output: html_document
---

This document illustrates the mortality of the Avengers using a colorblind friendly palette. The data are available at https://data.fivethirtyeight.com/.


```{r}
library(tidyverse)
library(waffle)
```

```{r data-import}
avengers <- read_csv("/Users/yedam/Documents/GitHub/DSP/Project/538-data/avengers/avengers.csv")
```

```{r insepct-data}
names(avengers)
glimpse(avengers)
```

### Mortality of the Avengers 
```{r mortality, fig.height=5, fig.width=6}


# What's the mortality rate of the Avengers?
# create a new column filled with the total number of the avengers
avengers <- avengers %>% 
mutate(total = nrow(avengers))
names(avengers)         

str(avengers$Death1)

# recode Death1 into numeric
avengers <- avengers %>% 
  mutate(death1_recode = recode(Death1, "YES" = '1',
                                "NO" = '0'))

view(avengers$death1_recode)
class(avengers$death1_recode)
avengers$death1_recode <- as.numeric(avengers$death1_recode)
avengers$death1_recode

```


```{r pie-chart}
# create a frequency proportion
death1 <- avengers %>% count(Death1)

# create a percentage variable
death1 <- death1 %>% 
  mutate(perc = round(100 * n / sum(n)))
death1 <- death1 %>% 
  mutate(perc_perc = paste0(perc, "%"))
death1

# create color blind friendly palette

# The palette with grey:

cb.palette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
                   
# create a pie chart using the original data set
pie = 
  death1 %>% 
  ggplot(aes(x = 0, y = perc, fill = Death1)) +
  geom_bar(stat = "identity", color = "black", width = 1) + 
  geom_text(aes(label = perc_perc), position = position_stack(vjust = 0.5)) +
  labs(fill = 'Has Died At Least Once', 
              x = NULL, 
              y = NULL, 
              title = 'Mortality of the Avengers'
              ) +
  coord_polar("y") +
  scale_fill_manual(values = cb.palette)

# create a blank theme
blank_theme <- 
  theme_void() + 
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.border = element_blank(),
        panel.grid = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 13, face = "bold"))

# apply blank them
pie + blank_theme



```

This pie chart shows that 40% of the Avengers have died at least once during their mission. 



### Mortality of the Avengers by Gender
```{r gender-mortality}

#What's the mortality rate of the Avengers by gender?
avengers %>% 
ggplot(mapping = aes(x = Gender, fill = Death1)) +
  geom_bar(colour="black") +
  coord_flip() +
  labs(x = "Death",
       y = "Gender",
       title = "Mortality of the Avengers",
       subtitle = "By gender",
       fill = "Died At Least Once") + 
    scale_fill_manual(values=cb.palette)


```

This bar chart shows that the mortality of the Avengers is significantly higher among males than among females. It is also notable that there are almost twice as many males as female Avengers. 

